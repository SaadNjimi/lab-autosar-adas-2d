/**************************************************************************************************\
 *** Os_Frm_generated.c
 *** 
 *** Generated by dSPACE VEOS 5.4
 *** 
 *** Using AutosarOs code generator 5.4.0.59380
 *** 
 *** Generated on: 2025-06-11 10:52:47
 *** 
 *** Copyright 2025 by dSPACE GmbH, Paderborn, Germany
 *** All Rights Reserved.
\**************************************************************************************************/

#ifndef OS_FRM_GENERATED_C
#define OS_FRM_GENERATED_C

/*------------------------------------------------------------------------------------------------*\
  INCLUDES
\*------------------------------------------------------------------------------------------------*/

/* OS include files. */
#include "Os.h"
#include "Os_Native.h"
#include "Os_Kernel.h"
#include "Os_Frame.h"
#include "Os_Task.h"
#include "VEOS.h"
#include "VEcuAppFrm_Os.h"
#include "Os_SimulationCore.h"
#include "Os_Cfg_generated.h"
#include <string.h>

/*------------------------------------------------------------------------------------------------*\
  VARIABLE DEFINITIONS
\*------------------------------------------------------------------------------------------------*/


/* Task priorities - for measurement purposes only. \nDeclared as array, since A2L cannot handle
 * pointers. */
Os_PrioType g_TaskPriorities[NUMBER_OF_TASKS] = 
{
    EcuM_StartupTwoTask_PRIO,   /* Measurable priority for task EcuM_StartupTwoTask */
    MainFunctionTask3_1ms_PRIO, /* Measurable priority for task MainFunctionTask3_1ms */
    Task0_10ms_PRIO,            /* Measurable priority for task Task0_10ms */
    Task1_PRIO,                 /* Measurable priority for task Task1 */
    IDLE_LOOP_PRIO              /* Measurable priority for task IDLE_LOOP */
};

/* Definition of tasks */
Os_TaskControlBlockType g_TaskCb[NUMBER_OF_TASKS] = OS_TASK_CONTROL_BLOCK;

#if NUMBER_OF_ALARMS > 0
/* Definition of alarms */
Os_AlarmControlBlockType g_AlarmCb[NUMBER_OF_ALARMS] = OS_ALARM_CONTROL_BLOCK;
#endif

#if NUMBER_OF_RESOURCES > 0
/* Definition of resources */
Os_ResourceControlBlockType g_ResCb[NUMBER_OF_RESOURCES] = OS_RESOURCE_CONTROL_BLOCK;
#endif

#if NUMBER_OF_SPINLOCKS > 0
/* Definition of spinlocks */
Os_SpinlockBlockType g_SpinlockCb[NUMBER_OF_SPINLOCKS] = OS_SPINLOCK_CONTROL_BLOCK;
#endif

#if NUMBER_OF_CORES > 0
/* Definition of cores */
Os_CoreControlBlockType g_CoreCb[NUMBER_OF_CORES] = OS_CORE_CONTROL_BLOCK;
#endif

#if NUMBER_OF_OS_APPLICATIONS > 0
/* Definition of applications */
Os_ApplicationControlBlockType g_ApplicationCb[NUMBER_OF_OS_APPLICATIONS] = 
    OS_APPLICATION_CONTROL_BLOCK;
#endif

/* Definition of interrupt service routines */
Os_IsrControlBlockType g_IsrCb[NUMBER_OF_ISRS] = OS_ISR_CONTROL_BLOCK;

#if NUMBER_OF_SCHEDULE_TABLES >= 1
#if NUMBER_OF_ALL_SCHED_TBL_EVENTS > 0
EventMaskType g_eventTbl[NUMBER_OF_ALL_SCHED_TBL_EVENTS] = OS_EXPIRY_POINTS_EVENTS;
Os_TaskControlBlockRefType g_taskEventTbl[NUMBER_OF_ALL_SCHED_TBL_EVENTS] = 
    OS_EXPIRY_POINTS_EVENT_TASKS;
#endif
#if NUMBER_OF_ALL_SCHED_TBL_TASKS > 0
Os_TaskControlBlockRefType g_taskTbl[NUMBER_OF_ALL_SCHED_TBL_TASKS] = OS_EXPIRY_POINTS_TASKS;
#endif
Os_ExpiryPointControlBlockType g_ExpPnts[NUMBER_OF_EXPIRY_POINTS] = OS_EXPIRY_POINTS_CONTROL_BLOCK;
Os_ScheduleTableControlBlockType g_SchedTbl[NUMBER_OF_SCHEDULE_TABLES] = 
    OS_SCHEDULE_TABLES_CONTROL_BLOCK;
Os_ScheduleTableControlBlockExecType g_SchedTblExec[NUMBER_OF_SCHEDULE_TABLES] = 
    OS_SCHEDULE_TABLES_EXEC_CONTROL_BLOCK;
#endif

#if NUMBER_OF_COUNTERS > 0
/* Definition of all counters (hardware and software) */
Os_CounterControlBlockType g_CtrCb[NUMBER_OF_COUNTERS] = OS_COUNTER_CONTROL_BLOCK;

/* Definition of hardware counters as subset of the counters */
CounterType g_HwCtr[NUMBER_OF_HW_COUNTERS] = OS_HARDWARE_COUNTER;
#endif


/*------------------------------------------------------------------------------------------------*\
  FUNCTION DEFINITIONS
\*------------------------------------------------------------------------------------------------*/

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_PreInit
 *** 
 *** DESCRIPTION:
 ***     Initialization of operating system emulator.
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_PreInit(void)
{
    CounterType counterId = 0;

    #ifdef OS_DBGMSG_ENABLED
    Os_SimulationCoreLogDbgMessage(__FUNCTION__, "Os_PreInit() entered.");
    #endif

    g_Kernel.SimTime = ((TickType) -1);

    /* initialize the counters */
    while(counterId < NUMBER_OF_COUNTERS)
    {
        g_CtrCb[counterId].OldSimTime = g_Kernel.SimTime;
        g_CtrCb[counterId].CtrValue = g_Kernel.SimTime;
        counterId++;
    }
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_Autostart
 *** 
 *** DESCRIPTION:
 ***     Auto-starts OS alarms and OS tasks for the current OS application mode during OS startup
 ***     procedure.
 *** 
 *** PARAMETERS:
 ***     Type             Name           Description
 ***     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ***     AppModeType      AppMode
 ***     ApplicationType  ApplicationId
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_Autostart(
    AppModeType AppMode,
    ApplicationType ApplicationId)
{
    static Os_BoolType VEcuAppRttIsCalled = OS_FALSE;

    /* return, if the AppMode is not supported. */
    if ((OSDEFAULTAPPMODE != AppMode) && (DONOTCARE != AppMode))
    {
        return;
    }

    /* Alarms, schedTables and tasks, which belong to no Os-Application, are started here. */
    if (OS_NOT_CONNECTED_TO_ANY_APPLICATION == ApplicationId)
    {
        Os_SetTaskReady(EcuM_StartupTwoTask);
    }

    if (VEcuAppRttIsCalled == OS_FALSE)
    {
        VEcuAppFrm_RttSetAsync();
        VEcuAppRttIsCalled = OS_TRUE;
    }
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_IsrSystemTimer
 *** 
 *** DESCRIPTION:
 ***     Interrupt service routine for system timer interrupt handling. This function triggers the
 ***     OS hardware counters.
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_IsrSystemTimer(void)
{
    CounterType hwCtr = 0;

    #ifdef OS_DBGMSG_ENABLED
    Os_SimulationCoreLogDbgMessage(__FUNCTION__, "Os_IsrSystemTimer() entered.");
    #endif

    g_Kernel.SimTime += 1;

    /* Set basic rate task to idle loop. */
    g_Kernel.ActiveBasicRateTask = IDLE_LOOP;

    /* Trigger OS counters. */
    while(hwCtr < NUMBER_OF_HW_COUNTERS)
    {
        if (g_HwCtr[hwCtr] < NUMBER_OF_COUNTERS)
        {
            Os_CounterTrigger(g_HwCtr[hwCtr]);
        }
        hwCtr++;

    }

    if (g_Kernel.IsStarted == OS_FALSE)
    {
        #if (NUMBER_OF_CORES > 0)
        /* A warning occurs if not all cores have been started. */
        Os_SendWarningOsKernelIsNotRunning();
        #else
        /* Single core behavior. */
        return;
        #endif
    }

    if (g_Kernel.AppMode == DONOTCARE)
    {
        /* [SWS_Os_00610] At least one core shall define an AppMode other than 'DONOTCARE'. */
        Os_SendWarningAppModeIsNotDefined();
    }

    Os_TaskStart(IDLE_LOOP);

    /* Set basic rate task to idle loop. */
    g_Kernel.ActiveBasicRateTask = IDLE_LOOP;

}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_InitDataStructsOfIoc
 *** 
 *** DESCRIPTION:
 ***     -/-
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_InitDataStructsOfIoc(void)
{
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_TaskInternal_EcuM_StartupTwoTask
 *** 
 *** DESCRIPTION:
 ***     Task function for TASK(EcuM_StartupTwoTask) 
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_TaskInternal_EcuM_StartupTwoTask(void)
{
    for (; ;)
    {
        Os_PreActivateTaskHook();
        if (0 == OS_SETJMP(returnToTask[EcuM_StartupTwoTask]))
        {
            Os_Task_EcuM_StartupTwoTask();
        }
    }
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_TaskInternal_MainFunctionTask3_1ms
 *** 
 *** DESCRIPTION:
 ***     Task function for TASK(MainFunctionTask3_1ms) 
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_TaskInternal_MainFunctionTask3_1ms(void)
{
    for (; ;)
    {
        Os_PreActivateTaskHook();
        if (0 == OS_SETJMP(returnToTask[MainFunctionTask3_1ms]))
        {
            Os_Task_MainFunctionTask3_1ms();
        }
    }
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_TaskInternal_Task0_10ms
 *** 
 *** DESCRIPTION:
 ***     Task function for TASK(Task0_10ms) 
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_TaskInternal_Task0_10ms(void)
{
    for (; ;)
    {
        Os_PreActivateTaskHook();
        if (0 == OS_SETJMP(returnToTask[Task0_10ms]))
        {
            Os_Task_Task0_10ms();
        }
    }
}

/**************************************************************************************************\
 *** FUNCTION:
 ***     Os_TaskInternal_Task1
 *** 
 *** DESCRIPTION:
 ***     Task function for TASK(Task1) 
 *** 
 *** PARAMETERS:
 ***     -/-
 *** 
 *** RETURNS:
 ***     void
\**************************************************************************************************/
void Os_TaskInternal_Task1(void)
{
    for (; ;)
    {
        Os_PreActivateTaskHook();
        if (0 == OS_SETJMP(returnToTask[Task1]))
        {
            Os_Task_Task1();
        }
    }
}

#endif /* OS_FRM_GENERATED_C */
/*------------------------------------------------------------------------------------------------*\
  END OF FILE
\*------------------------------------------------------------------------------------------------*/
